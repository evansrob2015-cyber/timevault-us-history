<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>US History TimeVault ‚Äì Kali</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050816;
      --bg-alt: #0b1020;
      --card: #111827;
      --accent: #fbbf24;
      --accent-soft: rgba(251, 191, 36, 0.15);
      --accent-strong: #f59e0b;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f87171;
      --good: #4ade80;
      --border-subtle: #1f2937;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.85);
      --radius-lg: 18px;
      --radius-pill: 999px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #111827 0, #020617 40%, #000 100%);
      color: var(--text-main);
      min-height: 100vh;
      padding: 24px;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app-shell {
      width: 100%;
      max-width: 1280px;
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      box-shadow: var(--shadow-soft);
      display: grid;
      grid-template-columns: 260px minmax(0, 1fr);
      overflow: hidden;
      position: relative;
    }

    @media (max-width: 900px) {
      body {
        padding: 8px;
      }
      .app-shell {
        grid-template-columns: 1fr;
      }
      .sidebar {
        flex-direction: row;
        overflow-x: auto;
        white-space: nowrap;
      }
      .nav-group-title {
        display: none;
      }
    }

    .sidebar {
      background: radial-gradient(circle at top, #020617, #020617 60%);
      border-right: 1px solid var(--border-subtle);
      padding: 20px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .brand-orb {
      width: 34px;
      height: 34px;
      border-radius: 40%;
      background: conic-gradient(from 210deg, #fbbf24, #f97316, #22d3ee, #a855f7, #fbbf24);
      box-shadow: 0 0 18px rgba(251, 191, 36, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 0.8rem;
      color: #020617;
    }

    .brand-text-main {
      font-weight: 650;
      letter-spacing: 0.04em;
      font-size: 0.95rem;
      text-transform: uppercase;
    }

    .brand-text-sub {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .nav-group-title {
      margin-top: 8px;
      font-size: 0.75rem;
      letter-spacing: 0.11em;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    .nav-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
    }

    .nav-item {
      border-radius: var(--radius-pill);
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text-muted);
      cursor: pointer;
      border: 1px solid transparent;
      transition: all 0.16s ease-out;
      white-space: nowrap;
    }

    .nav-item span.icon {
      width: 20px;
      text-align: center;
      font-size: 0.9rem;
    }

    .nav-item.active {
      background: radial-gradient(circle at top left, var(--accent-soft), transparent 80%);
      color: var(--text-main);
      border-color: rgba(251, 191, 36, 0.5);
    }

    .nav-item:hover {
      border-color: rgba(156, 163, 175, 0.7);
      color: var(--text-main);
    }

    .sidebar-footer {
      margin-top: auto;
      border-radius: 16px;
      padding: 10px 12px;
      background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.18), rgba(15, 23, 42, 0.9));
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .footer-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 2px 10px;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.6);
      font-size: 0.7rem;
      margin-bottom: 4px;
    }

    .footer-pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--good);
    }

    /* Main */
    .main-pane {
      padding: 18px 22px 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .top-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .top-title {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .top-title h1 {
      font-size: 1.4rem;
      letter-spacing: 0.03em;
    }

    .top-title p {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .streak-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: var(--radius-pill);
      background: rgba(22, 163, 74, 0.14);
      padding: 6px 11px;
      font-size: 0.8rem;
      border: 1px solid rgba(34, 197, 94, 0.5);
    }

    .streak-chip span.emoji {
      font-size: 1rem;
    }

    .layout-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(260px, 0.9fr);
      gap: 16px;
    }

    @media (max-width: 900px) {
      .layout-grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.98), rgba(2, 6, 23, 0.98));
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      padding: 14px 16px 14px;
      box-shadow: 0 14px 40px rgba(15, 23, 42, 0.7);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      gap: 10px;
      flex-wrap: wrap;
    }

    .card-title {
      font-size: 0.9rem;
      letter-spacing: 0.12em;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    .pill {
      border-radius: var(--radius-pill);
      padding: 3px 9px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .tab-strip {
      display: inline-flex;
      gap: 6px;
      padding: 3px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(31, 41, 55, 0.9);
      margin-bottom: 10px;
    }

    .tab-btn {
      border-radius: 999px;
      border: none;
      padding: 4px 12px;
      font-size: 0.78rem;
      cursor: pointer;
      background: transparent;
      color: var(--text-muted);
    }

    .tab-btn.active {
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.18), rgba(56, 189, 248, 0.1));
      color: var(--text-main);
    }

    .section {
      display: none;
      margin-top: 2px;
    }

    .section.active {
      display: block;
    }

    .unit-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 8px;
    }

    .unit-card {
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 10px 10px 9px;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.95));
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .unit-chip {
      font-size: 0.7rem;
      color: var(--accent-strong);
      text-transform: uppercase;
      letter-spacing: 0.13em;
    }

    .unit-title {
      margin-top: 3px;
      font-size: 0.95rem;
      font-weight: 600;
    }

    .unit-meta {
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .progress-bar-shell {
      margin-top: 7px;
      width: 100%;
      height: 5px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 1);
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #22c55e, #facc15);
      width: 32%;
    }

    .unit-card::after {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(circle at top left, rgba(251, 191, 36, 0.14), transparent 50%);
      opacity: 0;
      transition: opacity 0.2s ease-out;
      pointer-events: none;
    }

    .unit-card:hover::after {
      opacity: 1;
    }

    /* Mini-games list */
    .game-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 6px;
    }

    .game-card {
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 10px 11px;
      background: radial-gradient(circle at top, #020617, #020617 55%, #0b1120 100%);
      position: relative;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent-strong);
    }

    .game-title {
      margin-top: 5px;
      font-weight: 600;
      font-size: 0.98rem;
    }

    .game-desc {
      margin-top: 5px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .pill-row {
      margin-top: 7px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .pill-sm {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      padding: 2px 8px;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    /* Flashcards */
    .flashcard-shell {
      margin-top: 6px;
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.2fr);
      gap: 12px;
    }

    @media (max-width: 900px) {
      .flashcard-shell {
        grid-template-columns: 1fr;
      }
    }

    .flashcard {
      border-radius: 16px;
      padding: 20px 16px 18px;
      border: 1px solid rgba(55, 65, 81, 1);
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.98));
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .flashcard-label {
      font-size: 0.75rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .flashcard-term {
      margin-top: 12px;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .flashcard-body {
      margin-top: 8px;
      font-size: 0.86rem;
      color: var(--text-muted);
    }

    .flashcard-tip {
      margin-top: 12px;
      font-size: 0.78rem;
      color: var(--accent-strong);
    }

    .flashcard-footer {
      margin-top: 14px;
      font-size: 0.75rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    .btn-ghost {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.75rem;
      padding: 5px 10px;
      cursor: pointer;
    }

    .btn-ghost:hover {
      border-color: var(--accent-strong);
      color: var(--accent-strong);
    }

    .guide-panel {
      border-radius: 16px;
      padding: 14px 14px 12px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.15), rgba(15, 23, 42, 0.96));
      position: relative;
    }

    .guide-avatar {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, #22d3ee, #0ea5e9, #1d4ed8);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
    }

    .guide-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .guide-name {
      font-size: 0.85rem;
      font-weight: 600;
    }

    .guide-tag {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .guide-bubble {
      margin-top: 6px;
      font-size: 0.82rem;
      line-height: 1.4;
    }

    .guide-cta-row {
      margin-top: 9px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .guide-chip {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 3px 9px;
      font-size: 0.74rem;
      cursor: pointer;
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
    }

    .guide-chip:hover {
      border-color: var(--accent-strong);
      color: var(--accent-strong);
    }

    /* Parent dashboard */
    .parent-grid {
      margin-top: 6px;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.1fr);
      gap: 12px;
    }

    @media (max-width: 900px) {
      .parent-grid {
        grid-template-columns: 1fr;
      }
    }

    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      margin: 4px 0;
    }

    .metric-label {
      color: var(--text-muted);
    }

    .metric-value {
      font-weight: 600;
    }

    .question-list {
      margin-top: 8px;
      list-style: none;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .question-list li {
      padding: 4px 0;
    }

    .question-list li::before {
      content: "‚òÖ";
      margin-right: 6px;
      color: var(--accent-strong);
      font-size: 0.75rem;
    }

    .sass-meter {
      margin-top: 8px;
      border-radius: 14px;
      padding: 8px 10px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      font-size: 0.78rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .sass-bar-shell {
      width: 120px;
      height: 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 1);
      overflow: hidden;
    }

    .sass-bar-fill {
      width: 48%;
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #e879f9, #f97316);
    }

    .tag-muted {
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    /* Video library */
    .video-layout {
      margin-top: 8px;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.1fr);
      gap: 12px;
    }

    @media (max-width: 900px) {
      .video-layout {
        grid-template-columns: 1fr;
      }
    }

    .video-search-bar {
      display: flex;
      gap: 8px;
      margin: 6px 0 10px;
      flex-wrap: wrap;
    }

    .input-text {
      flex: 1;
      min-width: 160px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(55, 65, 81, 1);
      background: rgba(15, 23, 42, 0.9);
      padding: 6px 10px;
      color: var(--text-main);
      font-size: 0.82rem;
    }

    .input-text::placeholder {
      color: var(--text-muted);
    }

    .btn-primary {
      border-radius: var(--radius-pill);
      border: 1px solid rgba(251, 191, 36, 0.8);
      background: linear-gradient(135deg, #fbbf24, #f97316);
      color: #111827;
      font-size: 0.8rem;
      padding: 6px 12px;
      cursor: pointer;
      font-weight: 600;
      white-space: nowrap;
    }

    .btn-primary:hover {
      filter: brightness(1.05);
    }

    .video-result-list {
      margin-top: 6px;
      max-height: 260px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .video-item {
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 6px 8px;
      margin-bottom: 6px;
      font-size: 0.78rem;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.85);
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .video-item:hover {
      border-color: rgba(251, 191, 36, 0.8);
      background: radial-gradient(circle at top left, rgba(251, 191, 36, 0.1), rgba(15, 23, 42, 0.98));
    }

    .video-item-title {
      font-weight: 600;
      font-size: 0.8rem;
    }

    .video-item-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .video-viewer {
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(55, 65, 81, 1);
      background: #020617;
    }

    .video-embed {
      position: relative;
      padding-top: 56.25%;
    }

    .video-embed iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .video-viewer-meta {
      padding: 8px 10px 10px;
      font-size: 0.8rem;
    }

    .video-viewer-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .video-viewer-details {
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .video-tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.72rem;
      margin-top: 4px;
    }

    .video-tag {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      padding: 2px 7px;
      color: var(--text-muted);
    }

    .mini-label {
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    /* Timeline lab */
    .timeline-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 8px 0 10px;
    }

    .timeline-chip {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      padding: 4px 9px;
      font-size: 0.78rem;
      color: var(--text-muted);
      cursor: pointer;
      background: rgba(15, 23, 42, 0.9);
    }

    .timeline-chip.active {
      border-color: rgba(251, 191, 36, 0.9);
      color: var(--accent-strong);
      background: radial-gradient(circle at top left, rgba(251, 191, 36, 0.18), rgba(15, 23, 42, 0.98));
    }

    .timeline-layout {
      margin-top: 4px;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.1fr);
      gap: 12px;
    }

    @media (max-width: 900px) {
      .timeline-layout {
        grid-template-columns: 1fr;
      }
    }

    .timeline-reasoning {
      font-size: 0.82rem;
      color: var(--text-muted);
      line-height: 1.4;
    }

    .timeline-step-list {
      margin-top: 6px;
      font-size: 0.8rem;
      color: var(--text-muted);
      padding-left: 16px;
    }

    .timeline-step-list li {
      margin-bottom: 3px;
    }

    .timeline-videos {
      max-height: 230px;
      overflow-y: auto;
      padding-right: 4px;
    }

    /* Loading overlay */
    .loading-overlay {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top, #020617, #020617 60%, #000 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 10px;
      z-index: 20;
      transition: opacity 0.4s ease-out;
    }

    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 3px solid rgba(148, 163, 184, 0.4);
      border-top-color: #fbbf24;
      animation: spin 0.9s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .loading-text {
      font-size: 0.86rem;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <!-- Loading -->
    <div class="loading-overlay" id="loading-overlay">
      <div class="spinner"></div>
      <div class="loading-text">Booting the TimeVault for Kali...</div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
      <div>
        <div class="brand">
          <div class="brand-orb">TV</div>
          <div>
            <div class="brand-text-main">TimeVault US History</div>
            <div class="brand-text-sub">Kali‚Äôs Study Space ‚Ä¢ Practice ‚Ä¢ Integrity</div>
          </div>
        </div>
        <div class="nav-group-title">Learn</div>
        <div class="nav-list">
          <div class="nav-item active" data-section="home">
            <span class="icon">üè†</span>
            <span>Home</span>
          </div>
          <div class="nav-item" data-section="units">
            <span class="icon">üìö</span>
            <span>Units & Themes</span>
          </div>
          <div class="nav-item" data-section="games">
            <span class="icon">üéÆ</span>
            <span>Mini-Games</span>
          </div>
          <div class="nav-item" data-section="flashcards">
            <span class="icon">üß†</span>
            <span>Flashcards Lab</span>
          </div>
          <div class="nav-item" data-section="videos">
            <span class="icon">üì∫</span>
            <span>Video Library</span>
          </div>
          <div class="nav-item" data-section="timeline">
            <span class="icon">üìà</span>
            <span>Timeline Lab</span>
          </div>
          <div class="nav-item" data-section="dbq">
            <span class="icon">üìú</span>
            <span>DBQ Skills Lab</span>
          </div>
        </div>
        <div class="nav-group-title" style="margin-top:16px;">Family</div>
        <div class="nav-list">
          <div class="nav-item" data-section="parent">
            <span class="icon">üë®‚Äçüëß</span>
            <span>Parent View</span>
          </div>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="footer-pill">
          <div class="footer-pill-dot"></div>
          <span>AI Tutor Mode ‚Ä¢ No Homework Writing</span>
        </div>
        <div>
          This space is for practice, curiosity, and skill-building. Anything that looks like a graded assignment? We walk you <em>through</em> it, not <em>do</em> it.
        </div>
      </div>
    </aside>

    <!-- Main -->
    <main class="main-pane">
      <header class="top-header">
        <div class="top-title">
          <h1 id="page-title">Home</h1>
          <p id="page-subtitle">Hi Kali ‚Äî welcome back to the time machine. Where do you want to jump today?</p>
        </div>
        <div class="streak-chip" title="Study streak">
          <span class="emoji">üî•</span>
          <span>Sample streak ‚Ä¢ Tiny reps beat cramming</span>
        </div>
      </header>

      <div class="layout-grid">
        <!-- LEFT COLUMN: dynamic content -->
        <section class="card">
          <div class="card-header">
            <span class="card-title">Learning Mode</span>
            <div class="tab-strip" id="home-tabs">
              <button class="tab-btn active" data-home-tab="micro">Micro Burst</button>
              <button class="tab-btn" data-home-tab="deep">Deep Dive</button>
            </div>
          </div>

          <!-- HOME SECTION -->
          <div class="section active" id="section-home">
            <p class="tag-muted">Pick your next move. Each session keeps you in bounds with Brentwood‚Äôs AI policy while actually making history stick.</p>
            <div class="unit-grid" style="margin-top:10px;">
              <div class="unit-card">
                <div class="unit-chip">5‚Äì7 min</div>
                <div class="unit-title">Warm-Up Timeline: Colonies ‚Üí Revolution</div>
                <div class="unit-meta">
                  <span>Quick ordering game</span>
                  <span>üéÆ</span>
                </div>
                <div class="progress-bar-shell">
                  <div class="progress-bar-fill" style="width:45%"></div>
                </div>
              </div>
              <div class="unit-card">
                <div class="unit-chip">10 min</div>
                <div class="unit-title">Flashcard Sprint: Founding Documents</div>
                <div class="unit-meta">
                  <span>Spaced repetition</span>
                  <span>üß†</span>
                </div>
                <div class="progress-bar-shell">
                  <div class="progress-bar-fill" style="width:28%"></div>
                </div>
              </div>
              <div class="unit-card">
                <div class="unit-chip">15‚Äì20 min</div>
                <div class="unit-title">Mini-Scene: Voices of Reconstruction</div>
                <div class="unit-meta">
                  <span>Cinematic module</span>
                  <span>üé¨</span>
                </div>
                <div class="progress-bar-shell">
                  <div class="progress-bar-fill" style="width:60%"></div>
                </div>
              </div>
              <div class="unit-card">
                <div class="unit-chip">Skill</div>
                <div class="unit-title">Study Hack: How to Preview a Foner Chapter</div>
                <div class="unit-meta">
                  <span>Coaching only</span>
                  <span>üß≠</span>
                </div>
                <div class="progress-bar-shell">
                  <div class="progress-bar-fill" style="width:15%"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- UNITS SECTION -->
          <div class="section" id="section-units">
            <p class="tag-muted">Jump by era or theme. These are tuned to the <em>Give Me Liberty</em> sequence but only used for practice and understanding.</p>
            <div class="unit-grid">
              <div class="unit-card">
                <div class="unit-chip">Unit 1</div>
                <div class="unit-title">Pre-Columbian Worlds & First Contacts</div>
                <div class="unit-meta">
                  <span>Maps ‚Ä¢ Sources</span>
                  <span>üåé</span>
                </div>
                <div class="progress-bar-shell"><div class="progress-bar-fill" style="width:22%"></div></div>
              </div>
              <div class="unit-card">
                <div class="unit-chip">Unit 3</div>
                <div class="unit-title">Revolution & the Experiment of 1787</div>
                <div class="unit-meta">
                  <span>Debates ‚Ä¢ Games</span>
                  <span>‚öñÔ∏è</span>
                </div>
                <div class="progress-bar-shell"><div class="progress-bar-fill" style="width:55%"></div></div>
              </div>
              <div class="unit-card">
                <div class="unit-chip">Theme</div>
                <div class="unit-title">Liberty vs. Equality Across Time</div>
                <div class="unit-meta">
                  <span>Comparative practice</span>
                  <span>üß∑</span>
                </div>
                <div class="progress-bar-shell"><div class="progress-bar-fill" style="width:35%"></div></div>
              </div>
              <div class="unit-card">
                <div class="unit-chip">Theme</div>
                <div class="unit-title">Migration & Borders</div>
                <div class="unit-meta">
                  <span>Case studies</span>
                  <span>üß≥</span>
                </div>
                <div class="progress-bar-shell"><div class="progress-bar-fill" style="width:18%"></div></div>
              </div>
            </div>
          </div>

          <!-- MINI-GAMES SECTION -->
          <div class="section" id="section-games">
            <p class="tag-muted">Pick a game. You bring the brain; TimeVault brings the weirdly specific challenges.</p>
            <div class="game-list">
              <div class="game-card">
                <div class="badge"><span class="badge-dot"></span>Reading Skill</div>
                <div class="game-title">Decode the Primary Source</div>
                <div class="game-desc">You‚Äôre given a short document. Identify audience, purpose, and possible bias‚Äîno essays, just click-and-think.</div>
                <div class="pill-row">
                  <div class="pill-sm">Sourcing</div>
                  <div class="pill-sm">Context</div>
                  <div class="pill-sm">Practice mode</div>
                </div>
              </div>
              <div class="game-card">
                <div class="badge"><span class="badge-dot"></span>Strategy</div>
                <div class="game-title">Choose Your Colony</div>
                <div class="game-desc">Balance geography, economy, and politics to see how different colonies evolve. No grades, just consequences.</div>
                <div class="pill-row">
                  <div class="pill-sm">Colonial era</div>
                  <div class="pill-sm">Cause & effect</div>
                </div>
              </div>
              <div class="game-card">
                <div class="badge"><span class="badge-dot"></span>Timeline</div>
                <div class="game-title">Reconstruct the Road to War</div>
                <div class="game-desc">Drag events into order to see how small decisions snowball into big conflicts.</div>
                <div class="pill-row">
                  <div class="pill-sm">WWI / WWII</div>
                  <div class="pill-sm">Chronology</div>
                </div>
              </div>
              <div class="game-card">
                <div class="badge"><span class="badge-dot"></span>Media Literacy</div>
                <div class="game-title">Spot the Propaganda</div>
                <div class="game-desc">Analyze posters and headlines; choose what message they‚Äôre selling and to whom.</div>
                <div class="pill-row">
                  <div class="pill-sm">Visual sources</div>
                  <div class="pill-sm">Bias</div>
                </div>
              </div>
            </div>
          </div>

          <!-- FLASHCARDS SECTION -->
          <div class="section" id="section-flashcards">
            <p class="tag-muted">Tap to flip. These are examples of how the flashcard lab works ‚Äî always pushing you to explain ideas, not just peek at answers.</p>
            <div class="flashcard-shell">
              <div class="flashcard" id="flashcard">
                <div class="flashcard-label">Term</div>
                <div class="flashcard-term" id="flashcard-term">Republican Motherhood</div>
                <div class="flashcard-body" id="flashcard-body">Tap to reveal what this meant for women‚Äôs role in the early republic.</div>
                <div class="flashcard-tip">Pro tip: When you make your own cards, always include a ‚ÄúWhy does this matter?‚Äù line.</div>
                <div class="flashcard-footer">
                  <span>Deck: Early Republic ‚Ä¢ Card <span id="flashcard-index">1</span> / <span id="flashcard-total">3</span></span>
                  <button class="btn-ghost" id="next-card">Next example ‚ñ∏</button>
                </div>
              </div>
              <div class="guide-panel">
                <div class="guide-header">
                  <div class="guide-avatar">üßëüèΩ‚Äçüè´</div>
                  <div>
                    <div class="guide-name">Nova, Your Historian Guide</div>
                    <div class="guide-tag">‚ÄúI‚Äôm here to coach your brain, not steal your homework.‚Äù</div>
                  </div>
                </div>
                <div class="guide-bubble" id="guide-bubble">
                  Click the card once and try to say the answer out loud before you peek. Your brain loves being dramatic about recall.
                </div>
                <div class="guide-cta-row">
                  <button class="guide-chip" data-guide="strategy">How should I review a Foner chapter?</button>
                  <button class="guide-chip" data-guide="dbq">What does a DBQ actually want from me?</button>
                  <button class="guide-chip" data-guide="policy">What can you NOT do for me?</button>
                </div>
              </div>
            </div>
          </div>

          <!-- VIDEO LIBRARY SECTION -->
          <div class="section" id="section-videos">
            <p class="tag-muted">
              Search across a curated set of historian-approved videos. Results stay inside your vetted channels so you don‚Äôt fall into the YouTube void.
            </p>
            <div class="video-layout">
              <div>
                <div class="video-search-bar">
                  <input id="video-search-input" class="input-text" type="text"
                    placeholder="Try: market revolution, civil rights, Reconstruction, Great Depression‚Ä¶" />
                  <button class="btn-primary" id="video-search-button">Search videos</button>
                </div>
                <div class="mini-label">Showing <span id="video-count">0</span> matches from your TimeVault playlist.</div>
                <div class="video-result-list" id="video-results">
                  <!-- Filled by JS -->
                </div>
              </div>
              <div class="video-viewer" id="video-viewer">
                <div class="video-embed">
                  <iframe id="video-player" src="" allowfullscreen></iframe>
                </div>
                <div class="video-viewer-meta">
                  <div class="video-viewer-title" id="video-viewer-title">Pick a video on the left to start watching.</div>
                  <div class="video-viewer-details" id="video-viewer-details">
                    You‚Äôll see the title, channel, and why it‚Äôs useful for US History. Use these as launchpads for notes, not as background noise.
                  </div>
                  <div class="video-tag-row" id="video-viewer-tags"></div>
                  <p class="mini-label" style="margin-top:6px;">
                    Want to search the wider YouTube universe later? Your grown-up can turn on the ‚Äúreal web search‚Äù option once the backend is set up.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- TIMELINE LAB SECTION -->
          <div class="section" id="section-timeline">
            <p class="tag-muted">
              Timeline Lab helps you practice chronological reasoning: what came first, what overlapped, and how earlier choices shaped later crises.
            </p>
            <div class="timeline-chip-row" id="timeline-chips">
              <!-- Chips via JS -->
            </div>
            <div class="timeline-layout">
              <div>
                <div class="timeline-reasoning">
                  <strong id="timeline-title">Pick a period to start.</strong>
                  <p id="timeline-description" style="margin-top:4px;">
                    Chronological reasoning = telling the story of change over time without getting lost in the fog of dates.
                  </p>
                  <ul class="timeline-step-list" id="timeline-steps">
                    <li>Identify what‚Äôs starting in this period.</li>
                    <li>Notice what‚Äôs continuing from earlier.</li>
                    <li>Spot what‚Äôs ending or breaking.</li>
                  </ul>
                </div>
              </div>
              <div>
                <div class="card" style="padding:10px 12px;">
                  <div class="card-header">
                    <span class="card-title">Videos for this period</span>
                    <span class="pill">Sample mapping</span>
                  </div>
                  <div class="timeline-videos" id="timeline-videos">
                    <!-- Filled by JS -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- DBQ SECTION -->
          <div class="section" id="section-dbq">
            <p class="tag-muted">This lab explains DBQs and lets you practice the thinking moves‚Äînever the final writing.</p>
            <div class="flashcard-shell">
              <div class="guide-panel">
                <div class="guide-header">
                  <div class="guide-avatar">üìú</div>
                  <div>
                    <div class="guide-name">DBQ Move Map</div>
                    <div class="guide-tag">Six steps, zero cheating.</div>
                  </div>
                </div>
                <div class="guide-bubble">
                  1. Read the prompt. 2. Time travel in your head: what era, what themes? 3. Skim the docs for voices and perspectives.
                  4. Group them. 5. Plan a claim. 6. <em>Then</em> write‚Äîin your own words, outside this platform.
                </div>
                <div class="guide-cta-row">
                  <div class="guide-chip">View sample document set</div>
                  <div class="guide-chip">Practice grouping docs</div>
                  <div class="guide-chip">See thesis shapes (no full thesis)</div>
                </div>
              </div>
              <div class="card" style="padding:12px 14px;">
                <div class="card-header">
                  <span class="card-title">No-Essay Zone</span>
                  <span class="pill" style="border-color: rgba(248, 113, 113, 0.8); color: var(--danger);">Homework Writing Blocked</span>
                </div>
                <p style="font-size:0.82rem; color:var(--text-muted);">
                  Anytime you try to paste or ask for an actual DBQ paragraph, the system gently refuses and turns it into a thinking exercise instead. That keeps you aligned with Brentwood‚Äôs AI policy and your teacher‚Äôs rules.
                </p>
                <p style="font-size:0.8rem; color:var(--text-muted); margin-top:8px;">
                  Example redirect: <em>‚ÄúI can‚Äôt write that paragraph for you, but I can help you list 3 possible pieces of evidence and 2 ways to analyze them.‚Äù</em>
                </p>
              </div>
            </div>
          </div>

          <!-- PARENT SECTION -->
          <div class="section" id="section-parent">
            <p class="tag-muted">Snapshot for parents/guardians. No spying on assignments‚Äîjust patterns, progress, and conversation starters.</p>
            <div class="parent-grid">
              <div class="card" style="padding:10px 12px;">
                <div class="card-header">
                  <span class="card-title">Progress Overview</span>
                  <span class="pill">Sample Data</span>
                </div>
                <div class="metric-row">
                  <span class="metric-label">Overall practice completion</span>
                  <span class="metric-value">42%</span>
                </div>
                <div class="metric-row">
                  <span class="metric-label">Timeline confidence</span>
                  <span class="metric-value">Medium</span>
                </div>
                <div class="metric-row">
                  <span class="metric-label">Primary source skills</span>
                  <span class="metric-value" style="color:var(--good);">Improving</span>
                </div>
                <div class="metric-row">
                  <span class="metric-label">Last session length</span>
                  <span class="metric-value">18 min</span>
                </div>
                <div class="sass-meter">
                  <span>Sass Meter: Engagement vibe</span>
                  <div class="sass-bar-shell"><div class="sass-bar-fill"></div></div>
                </div>
              </div>

              <div class="card" style="padding:10px 12px;">
                <div class="card-header">
                  <span class="card-title">Dinner Table Questions</span>
                  <span class="pill">Conversation, not quizzing</span>
                </div>
                <ul class="question-list" id="question-list">
                  <li>Which historical figure this week felt the most human to you, and why?</li>
                  <li>What surprised you about how people justified slavery and freedom at the same time?</li>
                  <li>If you had to live in one of the colonies you studied, which would you choose and what trade-offs would you accept?</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <!-- RIGHT COLUMN: coach -->
        <aside class="card">
          <div class="card-header">
            <span class="card-title">Session Coach</span>
            <span class="pill" id="session-pill">Today: Focus on foundations</span>
          </div>
          <div style="font-size:0.82rem; color:var(--text-muted);">
            <p id="session-tip">
              Start with one micro-burst game, then do a 5-card flash review. Tiny reps win over heroic last-minute cram sessions.
            </p>
            <div style="margin-top:10px;">
              <span class="tag-muted">Suggested path:</span>
              <ul style="margin-top:4px; list-style:none;" id="session-path">
                <li style="padding:3px 0;">1. üéÆ Reconstruct the Road to War</li>
                <li style="padding:3px 0;">2. üß† Flashcard Sprint: Founding Documents</li>
                <li style="padding:3px 0;">3. üì∫ One video from the TimeVault playlist</li>
              </ul>
            </div>
          </div>
        </aside>
      </div>
    </main>
  </div>

  <script>
    // ---- NAV + SECTIONS ----
    const navItems = document.querySelectorAll('.nav-item');
    const sections = {
      home: document.getElementById('section-home'),
      units: document.getElementById('section-units'),
      games: document.getElementById('section-games'),
      flashcards: document.getElementById('section-flashcards'),
      videos: document.getElementById('section-videos'),
      timeline: document.getElementById('section-timeline'),
      dbq: document.getElementById('section-dbq'),
      parent: document.getElementById('section-parent')
    };

    const pageTitle = document.getElementById('page-title');
    const pageSubtitle = document.getElementById('page-subtitle');
    const sessionTip = document.getElementById('session-tip');
    const sessionPill = document.getElementById('session-pill');
    const sessionPath = document.getElementById('session-path');

    const subtitles = {
      home: 'Hi Kali ‚Äî welcome back to the time machine. Where do you want to jump today?',
      units: 'See the whole course like a map instead of a fog.',
      games: 'Play your way into understanding. Zero grades, maximum reps.',
      flashcards: 'Turn memorizing dust into quick, repeatable recall practice.',
      videos: 'Use historian-approved videos to deepen understanding, not replace reading.',
      timeline: 'Practice chronological reasoning so events feel like a story, not a pile.',
      dbq: 'Learn the DBQ moves so class day feels less mysterious.',
      parent: 'High-level patterns so grown-ups can support without hovering.'
    };

    const sessionConfigs = {
      home: {
        pill: 'Today: Focus on foundations',
        tip: 'Start with one micro-burst game, then do a 5-card flash review. Tiny reps win over heroic last-minute cram sessions.',
        path: [
          '1. üéÆ Reconstruct the Road to War',
          '2. üß† Flashcard Sprint: Founding Documents',
          '3. üì∫ One video from the TimeVault playlist'
        ]
      },
      videos: {
        pill: 'Today: Context & big pictures',
        tip: 'Use one video as a launchpad. Pause every few minutes and jot a 3-word summary of what just changed.',
        path: [
          '1. üì∫ Search for the current unit topic',
          '2. ‚úçüèΩ Pause and write ‚ÄúBefore ‚Üí After‚Äù notes',
          '3. üîÅ Review your notes against the timeline'
        ]
      },
      timeline: {
        pill: 'Today: Chronological reasoning',
        tip: 'Pick a period, list 3 things starting, 2 things continuing, and 1 thing ending. That‚Äôs the skeleton of a strong essay.',
        path: [
          '1. üìà Choose a period in the Timeline Lab',
          '2. üîç Watch 1‚Äì2 mapped videos',
          '3. üß© Connect this era to the next one'
        ]
      },
      default: {
        pill: 'Today: Focus on foundations',
        tip: 'Start with one micro-burst game, then do a 5-card flash review. Tiny reps win over heroic last-minute cram sessions.',
        path: [
          '1. üéÆ Reconstruct the Road to War',
          '2. üß† Flashcard Sprint: Founding Documents',
          '3. üì∫ One video from the TimeVault playlist'
        ]
      }
    };

    function updateSessionCoach(sectionKey) {
      const config = sessionConfigs[sectionKey] || sessionConfigs.default;
      sessionPill.textContent = config.pill;
      sessionTip.textContent = config.tip;
      sessionPath.innerHTML = '';
      config.path.forEach(line => {
        const li = document.createElement('li');
        li.style.padding = '3px 0';
        li.textContent = line;
        sessionPath.appendChild(li);
      });
    }

    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const target = item.getAttribute('data-section');
        navItems.forEach(i => i.classList.remove('active'));
        item.classList.add('active');
        Object.entries(sections).forEach(([key, el]) => {
          el.classList.toggle('active', key === target);
        });
        pageTitle.textContent = item.innerText.trim();
        pageSubtitle.textContent = subtitles[target];
        updateSessionCoach(target);
      });
    });

    // Home micro/deep toggle (visual only)
    const homeTabs = document.querySelectorAll('[data-home-tab]');
    homeTabs.forEach(btn => {
      btn.addEventListener('click', () => {
        homeTabs.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    // ---- FLASHCARDS ----
    const flashcard = document.getElementById('flashcard');
    const termEl = document.getElementById('flashcard-term');
    const bodyEl = document.getElementById('flashcard-body');
    const nextBtn = document.getElementById('next-card');
    const cardIndexEl = document.getElementById('flashcard-index');
    const cardTotalEl = document.getElementById('flashcard-total');

    const flashData = [
      {
        term: 'Republican Motherhood',
        front: 'Tap to reveal what this meant for women‚Äôs role in the early republic.',
        back: 'The idea that women should be educated so they could raise virtuous citizens. Not political equality yet‚Äîbut a step toward recognizing women‚Äôs influence.'
      },
      {
        term: 'Great Migration',
        front: 'Tap to recall why hundreds of thousands of Black Americans moved north in the early 1900s.',
        back: 'A mass movement out of the Jim Crow South seeking industrial jobs and a measure of safety and political voice in northern cities.'
      },
      {
        term: 'Containment',
        front: 'Tap to remember the core idea of U.S. Cold War strategy.',
        back: 'The policy of stopping the spread of communism by supporting allies and intervening where leaders believed Soviet influence might expand.'
      }
    ];

    let cardIndex = 0;
    let flipped = false;

    function renderCard() {
      const card = flashData[cardIndex];
      termEl.textContent = card.term;
      bodyEl.textContent = flipped ? card.back : card.front;
      cardIndexEl.textContent = String(cardIndex + 1);
      cardTotalEl.textContent = String(flashData.length);
    }

    flashcard.addEventListener('click', (e) => {
      if (e.target === nextBtn) return;
      flipped = !flipped;
      renderCard();
    });

    nextBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      cardIndex = (cardIndex + 1) % flashData.length;
      flipped = false;
      renderCard();
    });

    renderCard();

    // Guide chips
    const guideBubble = document.getElementById('guide-bubble');
    const guideChips = document.querySelectorAll('.guide-chip[data-guide]');
    const guideMessages = {
      strategy: 'Preview first. Skim headings, bold terms, and the intro/conclusion. Predict the 3 big ideas before you read. Then check yourself as you go.',
      dbq: 'A DBQ wants to see you use documents as evidence, not decoration. Your superpower: grouping docs into 2‚Äì3 buckets that support a clear claim.',
      policy: 'I stay on the right side of your school‚Äôs AI policy: I can explain, question, and coach‚Äîbut I will not write your homework, your DBQs, or anything you submit.'
    };
    guideChips.forEach(chip => {
      chip.addEventListener('click', () => {
        const key = chip.getAttribute('data-guide');
        if (!key || !guideMessages[key]) return;
        guideBubble.textContent = guideMessages[key];
      });
    });

    // ---- CURATED VIDEO DATA ----
    const curatedVideos = [
      // A. Cross-Period Survey / Review
      {
        id: 1,
        title: 'US History Overview playlist',
        channel: 'Khan Academy',
        url: 'https://www.youtube.com/playlist?list=PLtyN34w6H7y6m9kC5XHzTeziYGZ41UQtF',
        period: 'Survey',
        years: 'Jamestown‚ÄìPresent',
        why: 'Jamestown through modern America in three big arcs; great for unit kickoff or final review.',
        tags: ['overview', 'review', 'survey', 'khan academy']
      },
      {
        id: 2,
        title: 'AP US History Study Guide playlist',
        channel: 'Gilder Lehrman Institute',
        url: 'https://www.youtube.com/playlist?list=PLVggCKD8PzezOKldtzRzTjwuwyuiLVFjT',
        period: 'Survey',
        years: 'All periods',
        why: 'Eric Foner & co. framing each APUSH period. Great anchor explanations.',
        tags: ['overview', 'apush', 'foner', 'gilder lehrman']
      },
      {
        id: 3,
        title: 'Eric Foner on Understanding Our History',
        channel: 'Big Think',
        url: 'https://www.youtube.com/watch?v=ewzrit2mMLM',
        period: 'Survey',
        years: 'General',
        why: 'Why knowing US history matters, and what gets left out. Perfect for day 1 or reset.',
        tags: ['foner', 'historiography', 'big think']
      },
      {
        id: 4,
        title: 'Is American History Cyclical or Progressive? (Ken Burns)',
        channel: 'Big Think',
        url: 'https://www.youtube.com/watch?v=PhnoQRzQJ60',
        period: 'Survey',
        years: 'General',
        why: 'Big framing question you can revisit after any major crisis unit.',
        tags: ['ken burns', 'big think', 'overview']
      },

      // B. Period 1‚Äì2
      {
        id: 5,
        title: 'Native American societies before contact',
        channel: 'Khan Academy',
        url: 'https://www.youtube.com/watch?v=Ht0FW7RwRmc',
        period: 'Period 1‚Äì2',
        years: 'Pre-1492',
        why: 'Excellent for APUSH Key Concept 1.1; regions, environment, and diversity.',
        tags: ['period 1', 'indigenous', 'pre-contact', 'khan academy']
      },
      {
        id: 6,
        title: 'The Columbian Exchange',
        channel: 'Khan Academy',
        url: 'https://www.youtube.com/watch?v=pLijVYVDKlc',
        period: 'Period 1‚Äì2',
        years: '1492‚Äì1600s',
        why: 'Biological, demographic, and economic changes across the Atlantic.',
        tags: ['columbian exchange', 'period 1', 'khan academy']
      },
      {
        id: 7,
        title: 'Spanish colonization | Period 1: 1491‚Äì1607',
        channel: 'Khan Academy',
        url: 'https://www.youtube.com/watch?v=uWj0GCvn_Oo',
        period: 'Period 1‚Äì2',
        years: '1491‚Äì1607',
        why: 'Spanish empire, encomienda, and early empire building.',
        tags: ['spanish', 'colonization', 'period 1']
      },
      {
        id: 8,
        title: 'US History Overview 1: Jamestown to the Civil War',
        channel: 'Khan Academy',
        url: 'https://www.youtube.com/watch?v=ghgPq2wjQUQ',
        period: 'Period 2‚Äì5',
        years: '1607‚Äì1865',
        why: 'Long arc from early colonies forward; helpful big picture.',
        tags: ['overview', 'jamestown', 'civil war']
      },

      // C. Period 3
      {
        id: 9,
        title: 'Causes of the American Revolution: Parent-Child Analogies',
        channel: 'Mr. Beat',
        url: 'https://www.youtube.com/watch?v=ilOhWwexHnI',
        period: 'Period 3',
        years: '1760s‚Äì1770s',
        why: 'Accessible emotional analogy for salutary neglect, taxes, and rebellion.',
        tags: ['american revolution', 'causes', 'mr beat']
      },
      {
        id: 10,
        title: 'The American Revolution: Telling Our Origin Story',
        channel: 'PBS Origins',
        url: 'https://www.youtube.com/watch?v=vTlqT_FjL5k',
        period: 'Period 3',
        years: '1770s‚Äì1780s',
        why: 'How we remember the Revolution and what that memory hides.',
        tags: ['revolution', 'memory', 'pbs origins']
      },
      {
        id: 11,
        title: 'Separation of Powers | Constitution 101',
        channel: 'National Constitution Center',
        url: 'https://www.youtube.com/watch?v=6bF3Jsrv_yM',
        period: 'Period 3',
        years: '1780s‚Äì1790s',
        why: 'Structure of the federal government; good intro before cases and amendments.',
        tags: ['constitution', 'separation of powers']
      },
      {
        id: 12,
        title: 'The Bill of Rights in Less Than Two Minutes',
        channel: 'Mr. Beat',
        url: 'https://www.youtube.com/shorts/-tnfrBMXiqE',
        period: 'Period 3',
        years: '1791',
        why: 'Lightning-fast overview of the first ten amendments.',
        tags: ['bill of rights', 'amendments']
      },
      {
        id: 13,
        title: 'Why is the Constitution Relevant Today?',
        channel: 'Mr. Beat',
        url: 'https://www.youtube.com/watch?v=ctAOE9QMj-k',
        period: 'Period 3‚Äì9',
        years: '1787‚Äìpresent',
        why: 'Connects 1787 to now; helpful for debates about a ‚Äúliving‚Äù Constitution.',
        tags: ['constitution', 'modern relevance']
      },

      // D. Period 4
      {
        id: 14,
        title: 'David Shi on the Market Revolution',
        channel: 'Norton History',
        url: 'https://www.youtube.com/watch?v=UiMak5pVvfY',
        period: 'Period 4',
        years: '1800‚Äì1848',
        why: 'Defines the Market Revolution and its social consequences.',
        tags: ['market revolution', 'economy', 'norton']
      },
      {
        id: 15,
        title: 'Eric Foner on the Market Revolution',
        channel: 'Norton History',
        url: 'https://www.youtube.com/watch?v=JUrLjs4IRcc&t=21s',
        period: 'Period 4',
        years: '1800‚Äì1848',
        why: 'Foner‚Äôs angle on labor, regional change, and politics.',
        tags: ['market revolution', 'foner', 'period 4']
      },

      // E. Period 5
      {
        id: 16,
        title: 'MOOC | The Compromise of 1850',
        channel: 'ColumbiaLearn',
        url: 'https://www.youtube.com/watch?v=dwralA6-yHM',
        period: 'Period 5',
        years: '1850s',
        why: 'Great for sectional tensions and the ‚Äúcould we have avoided war?‚Äù question.',
        tags: ['compromise of 1850', 'civil war causes']
      },
      {
        id: 17,
        title: 'MOOC | Lincoln, the Republican Party & the War',
        channel: 'ColumbiaLearn',
        url: 'https://www.youtube.com/watch?v=Zvu4XXZprcw',
        period: 'Period 5',
        years: '1850s‚Äì1860s',
        why: 'Foner on party politics, slavery, and the coming of war.',
        tags: ['lincoln', 'republican party', 'civil war']
      },
      {
        id: 18,
        title: 'How Spy Balloons Changed the Civil War',
        channel: 'PBS Origins',
        url: 'https://www.youtube.com/watch?v=7lUwEwYLlB0',
        period: 'Period 5',
        years: '1861‚Äì1865',
        why: 'Tech, surveillance, and industrial war‚Äînice STEM crossover.',
        tags: ['civil war', 'technology', 'balloons']
      },
      {
        id: 19,
        title: 'Lectures in History: Reconstruction & America\'s Story',
        channel: 'American History TV (C-SPAN)',
        url: 'https://www.youtube.com/watch?v=LgsB7thsFWQ',
        period: 'Period 5‚Äì6',
        years: '1865‚Äì1877',
        why: 'Reconstruction as central, not epilogue‚Äîfull lecture, very APUSH-aligned.',
        tags: ['reconstruction', 'c-span']
      },
      {
        id: 20,
        title: 'MOOC | "Black Reconstruction"',
        channel: 'ColumbiaLearn',
        url: 'https://www.youtube.com/watch?v=SHbBiKHWozE',
        period: 'Period 5‚Äì6',
        years: 'Reconstruction',
        why: 'Du Bois, memory, and the politics of how Reconstruction is remembered.',
        tags: ['black reconstruction', 'du bois', 'reconstruction']
      },

      // F. Period 6
      {
        id: 21,
        title: 'MOOC WHAW1.1x | 8.3.5 The Triangle Fire',
        channel: 'ColumbiaLearn',
        url: 'https://www.youtube.com/watch?v=-vVxxmsDFJk',
        period: 'Period 6‚Äì7',
        years: '1911',
        why: 'Industrialization, labor, and reform via the Triangle Shirtwaist Factory fire.',
        tags: ['triangle fire', 'labor', 'progressive era']
      },

      // G. Period 7
      {
        id: 22,
        title: 'The Great Migration',
        channel: 'PBS Origins',
        url: 'https://www.youtube.com/watch?v=ucRitZT68MA',
        period: 'Period 7‚Äì8',
        years: '1910s‚Äì1930s',
        why: 'The Great Migration as an urban revolution in cities like Chicago and Detroit.',
        tags: ['great migration', 'african american history']
      },
      {
        id: 23,
        title: 'Lecture on The Great Depression',
        channel: 'American History TV (C-SPAN)',
        url: 'https://www.youtube.com/watch?v=IjQ8jLYvv1Q',
        period: 'Period 7',
        years: '1930s',
        why: 'Long-form lecture on origins and impact of the Depression.',
        tags: ['great depression', 'c-span']
      },
      {
        id: 24,
        title: 'How the New Deal Left Out African-Americans',
        channel: 'American History TV (C-SPAN)',
        url: 'https://www.youtube.com/watch?v=r9hFVr-zmIg',
        period: 'Period 7',
        years: '1930s',
        why: 'Perfect for ‚Äúwho benefitted / who was excluded‚Äù discussions about the New Deal.',
        tags: ['new deal', 'race', 'c-span']
      },
      {
        id: 25,
        title: 'MOOC WHAW 1.2x | Section 15: Was World War II a watershed for women?',
        channel: 'ColumbiaLearn',
        url: 'https://www.youtube.com/playlist?list=PLSuwqsAnJMtw4xt9P690B7IE5vp4cxgPw',
        period: 'Period 7',
        years: '1940s',
        why: 'Playlist on women‚Äôs labor and daily life during WWII‚Äîprimary-source heavy.',
        tags: ['world war ii', 'women', 'labor']
      },

      // H. Period 8
      {
        id: 26,
        title: 'Sound Smart: The Freedom Rides',
        channel: 'History Channel',
        url: 'https://www.youtube.com/watch?v=dJqA6PQRh3U',
        period: 'Period 8',
        years: '1961',
        why: 'Short explainer of Freedom Rides strategy and impact.',
        tags: ['civil rights', 'freedom rides']
      },
      {
        id: 27,
        title: '7 Civil Rights Leaders You Need to Know | History Countdown',
        channel: 'History Channel',
        url: 'https://www.youtube.com/watch?v=fiNLaSj69Dw',
        period: 'Period 8',
        years: '1950s‚Äì1960s',
        why: 'Quick ‚Äúfaces of the movement‚Äù survey: not just MLK.',
        tags: ['civil rights', 'leaders']
      },
      {
        id: 28,
        title: 'Civil Rights Turning Points in Every Decade | History by The Decade',
        channel: 'History Channel',
        url: 'https://www.youtube.com/watch?v=0UOTLqmRr2U',
        period: 'Period 8‚Äì9',
        years: 'Mid-20th century‚Äìpresent',
        why: 'Longer arc view of civil rights from mid-20th century forward.',
        tags: ['civil rights', 'timeline']
      },
      {
        id: 29,
        title: 'Freedom Summer of 1964: Black Americans\' Fight for Voting Rights',
        channel: 'American History TV (C-SPAN)',
        url: 'https://www.youtube.com/watch?v=vfwJJapQ5KY',
        period: 'Period 8',
        years: '1964',
        why: 'Drills into one campaign‚Äîgreat with SNCC, CORE, or primary sources.',
        tags: ['freedom summer', 'voting rights']
      },

      // I. Period 9
      {
        id: 30,
        title: 'Why the wars America starts are unwinnable',
        channel: 'Big Think',
        url: 'https://www.youtube.com/watch?v=o0ONByhAHC4',
        period: 'Period 9',
        years: 'Vietnam‚ÄìIraq/Afghanistan',
        why: 'Vietnam to Iraq/Afghanistan; great for post-Cold War foreign policy conversations.',
        tags: ['foreign policy', 'wars', 'big think']
      },
      {
        id: 31,
        title: 'The neoliberal era is ending. What comes next?',
        channel: 'Big Think',
        url: 'https://www.youtube.com/watch?v=zEBhiNRiNCI',
        period: 'Period 9',
        years: '1980s‚Äìpresent',
        why: 'Ties Reagan-era economics, globalization, and contemporary backlash together.',
        tags: ['neoliberalism', 'economy', 'big think']
      }
    ];

    // ---- VIDEO SEARCH + VIEWER ----
    const videoSearchInput = document.getElementById('video-search-input');
    const videoSearchButton = document.getElementById('video-search-button');
    const videoResults = document.getElementById('video-results');
    const videoCount = document.getElementById('video-count');
    const videoPlayer = document.getElementById('video-player');
    const videoViewerTitle = document.getElementById('video-viewer-title');
    const videoViewerDetails = document.getElementById('video-viewer-details');
    const videoViewerTags = document.getElementById('video-viewer-tags');

    function getEmbedUrl(url) {
      try {
        const u = new URL(url);
        if (u.hostname.includes('youtube.com')) {
          const listId = u.searchParams.get('list');
          const vId = u.searchParams.get('v');
          if (listId && !vId) {
            return 'https://www.youtube.com/embed/videoseries?list=' + listId;
          }
          if (vId) {
            return 'https://www.youtube.com/embed/' + vId;
          }
          if (u.pathname.startsWith('/shorts/')) {
            const id = u.pathname.split('/shorts/')[1].split('?')[0];
            return 'https://www.youtube.com/embed/' + id;
          }
        }
        return url;
      } catch (e) {
        return url;
      }
    }

    function renderVideoResults(list) {
      videoResults.innerHTML = '';
      videoCount.textContent = String(list.length);
      if (!list.length) {
        const empty = document.createElement('div');
        empty.className = 'mini-label';
        empty.style.marginTop = '6px';
        empty.textContent = 'No matches yet. Try a broader term like ‚ÄúRevolution,‚Äù ‚ÄúCivil War,‚Äù or ‚ÄúCivil Rights.‚Äù';
        videoResults.appendChild(empty);
        return;
      }
      list.forEach(video => {
        const div = document.createElement('div');
        div.className = 'video-item';
        div.addEventListener('click', () => setActiveVideo(video));
        const title = document.createElement('div');
        title.className = 'video-item-title';
        title.textContent = video.title;
        const meta = document.createElement('div');
        meta.className = 'video-item-meta';
        meta.innerHTML = `
          <span>${video.channel}</span>
          <span>‚Ä¢ ${video.period}</span>
          <span>‚Ä¢ ${video.years}</span>
        `;
        const why = document.createElement('div');
        why.className = 'mini-label';
        why.textContent = video.why;
        div.appendChild(title);
        div.appendChild(meta);
        div.appendChild(why);
        videoResults.appendChild(div);
      });
    }

    function setActiveVideo(video) {
      const embedUrl = getEmbedUrl(video.url);
      videoPlayer.src = embedUrl;
      videoViewerTitle.textContent = video.title;
      videoViewerDetails.textContent = `${video.channel} ‚Ä¢ ${video.period} ‚Ä¢ ${video.years}. ${video.why}`;
      videoViewerTags.innerHTML = '';
      video.tags.forEach(t => {
        const span = document.createElement('span');
        span.className = 'video-tag';
        span.textContent = t;
        videoViewerTags.appendChild(span);
      });
    }

    function filterVideos(query) {
      const q = query.trim().toLowerCase();
      if (!q) return curatedVideos;
      return curatedVideos.filter(v => {
        const haystack = (v.title + ' ' + v.channel + ' ' + v.period + ' ' + v.years + ' ' + v.tags.join(' ')).toLowerCase();
        return haystack.includes(q);
      });
    }

    function performVideoSearch() {
      const query = videoSearchInput.value;
      const list = filterVideos(query);
      renderVideoResults(list);
      if (list.length) {
        setActiveVideo(list[0]);
      } else {
        videoPlayer.src = '';
        videoViewerTitle.textContent = 'No curated match yet.';
        videoViewerDetails.textContent = 'Try a broader topic. This search only looks inside your vetted TimeVault playlist.';
        videoViewerTags.innerHTML = '';
      }
    }

    videoSearchButton.addEventListener('click', performVideoSearch);
    videoSearchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') performVideoSearch();
    });

    // initial render (no filter)
    renderVideoResults(curatedVideos.slice(0, 6));
    if (curatedVideos.length) setActiveVideo(curatedVideos[0]);

    // ---- TIMELINE LAB ----
    const timelineChipsContainer = document.getElementById('timeline-chips');
    const timelineTitle = document.getElementById('timeline-title');
    const timelineDescription = document.getElementById('timeline-description');
    const timelineSteps = document.getElementById('timeline-steps');
    const timelineVideosContainer = document.getElementById('timeline-videos');

    const timelinePeriods = [
      {
        key: 'Survey',
        label: 'Survey / Big Picture',
        years: '1491‚ÄìPresent',
        description: 'Use these to zoom out and see how different eras connect. Great for review or before a big unit.',
        steps: [
          'List three eras you can spot in the overview.',
          'For each era, name one major turning point.',
          'Decide where your current class unit sits in that big picture.'
        ]
      },
      {
        key: 'Period 1‚Äì2',
        label: 'Period 1‚Äì2 ‚Ä¢ 1491‚Äì1754',
        years: '1491‚Äì1754',
        description: 'Pre-contact Indigenous worlds, European colonization, and early English colonies.',
        steps: [
          'Identify what is new after 1492 (Columbian Exchange).',
          'Notice what stays the same for Indigenous nations.',
          'Track how Spanish vs. English strategies diverge over time.'
        ]
      },
      {
        key: 'Period 3',
        label: 'Period 3 ‚Ä¢ 1754‚Äì1800',
        years: '1754‚Äì1800',
        description: 'French & Indian War, Revolution, and the Constitution.',
        steps: [
          'List 3 causes of the Revolution in rough time order.',
          'Connect one Revolutionary idea to a clause in the Constitution.',
          'Explain how the 1790s show tension between ideals and reality.'
        ]
      },
      {
        key: 'Period 4',
        label: 'Period 4 ‚Ä¢ 1800‚Äì1848',
        years: '1800‚Äì1848',
        description: 'Market Revolution, democratization, and early reform movements.',
        steps: [
          'Describe how transportation and markets changed daily life.',
          'Explain how politics opened up (and for whom).',
          'Connect the Market Revolution to later sectional tension.'
        ]
      },
      {
        key: 'Period 5',
        label: 'Period 5 ‚Ä¢ 1844‚Äì1877',
        years: '1844‚Äì1877',
        description: 'Expansion, Civil War, and Reconstruction.',
        steps: [
          'Place at least four key events between 1850 and 1861 in order.',
          'Explain why Reconstruction is a beginning, not just an ending.',
          'Connect one Reconstruction choice to a 20th-century consequence.'
        ]
      },
      {
        key: 'Period 6‚Äì7',
        label: 'Periods 6‚Äì7 ‚Ä¢ 1865‚Äì1945',
        years: '1865‚Äì1945',
        description: 'Industrialization, Progressive Era, Great Depression, New Deal, and WWII.',
        steps: [
          'Identify when industrialization really starts reshaping cities.',
          'Track how the Great Depression changes the role of government.',
          'Explain how WWII builds on earlier economic and social trends.'
        ]
      },
      {
        key: 'Period 8',
        label: 'Period 8 ‚Ä¢ 1945‚Äì1980',
        years: '1945‚Äì1980',
        description: 'Cold War and Civil Rights movements.',
        steps: [
          'Place Brown v. Board, Montgomery Bus Boycott, and Freedom Summer in order.',
          'Connect one Cold War moment to a domestic civil rights struggle.',
          'Explain how tactics evolve from the 1950s to the late 1960s.'
        ]
      },
      {
        key: 'Period 9',
        label: 'Period 9 ‚Ä¢ 1980‚ÄìPresent',
        years: '1980‚ÄìPresent',
        description: 'Conservatism, globalization, and debates over US power.',
        steps: [
          'Summarize what ‚Äúneoliberalism‚Äù means in one sentence.',
          'Connect one Cold War policy choice to a 21st-century conflict.',
          'Explain one way economic policy shapes democracy today.'
        ]
      }
    ];

    function renderTimelineChips() {
      timelineChipsContainer.innerHTML = '';
      timelinePeriods.forEach((p, idx) => {
        const chip = document.createElement('button');
        chip.type = 'button';
        chip.className = 'timeline-chip' + (idx === 0 ? ' active' : '');
        chip.dataset.period = p.key;
        chip.textContent = p.label;
        chip.addEventListener('click', () => {
          document.querySelectorAll('.timeline-chip').forEach(c => c.classList.remove('active'));
          chip.classList.add('active');
          setTimelinePeriod(p.key);
        });
        timelineChipsContainer.appendChild(chip);
      });
      // default to first
      if (timelinePeriods.length) setTimelinePeriod(timelinePeriods[0].key);
    }

    function setTimelinePeriod(key) {
      const p = timelinePeriods.find(t => t.key === key);
      if (!p) return;
      timelineTitle.textContent = p.label + ' (' + p.years + ')';
      timelineDescription.textContent = p.description;
      timelineSteps.innerHTML = '';
      p.steps.forEach(s => {
        const li = document.createElement('li');
        li.textContent = s;
        timelineSteps.appendChild(li);
      });

      // filter videos that match this period key
      let vids;
      if (key === 'Survey') {
        vids = curatedVideos.filter(v => v.period === 'Survey');
      } else if (key === 'Period 6‚Äì7') {
        vids = curatedVideos.filter(v => v.period === 'Period 6‚Äì7' || v.period === 'Period 7' || v.period === 'Period 6‚Äì7' || v.period === 'Period 7‚Äì8');
      } else if (key === 'Period 8') {
        vids = curatedVideos.filter(v => v.period === 'Period 8' || v.period === 'Period 7‚Äì8' || v.period === 'Period 8‚Äì9');
      } else {
        vids = curatedVideos.filter(v => v.period === key);
      }

      timelineVideosContainer.innerHTML = '';
      if (!vids.length) {
        const none = document.createElement('div');
        none.className = 'mini-label';
        none.textContent = 'No mapped videos yet. This just means the human curator (hi) hasn‚Äôt filled this slot.';
        timelineVideosContainer.appendChild(none);
        return;
      }

      vids.forEach(v => {
        const div = document.createElement('div');
        div.className = 'video-item';
        div.addEventListener('click', () => {
          setActiveVideo(v);
          // switch to videos tab
          document.querySelector('.nav-item[data-section="videos"]').click();
        });
        const title = document.createElement('div');
        title.className = 'video-item-title';
        title.textContent = v.title;
        const meta = document.createElement('div');
        meta.className = 'video-item-meta';
        meta.innerHTML = `<span>${v.channel}</span><span>‚Ä¢ ${v.years}</span>`;
        const why = document.createElement('div');
        why.className = 'mini-label';
        why.textContent = v.why;
        div.appendChild(title);
        div.appendChild(meta);
        div.appendChild(why);
        timelineVideosContainer.appendChild(div);
      });
    }

    renderTimelineChips();

    // ---- LOADING OVERLAY ----
    const loadingOverlay = document.getElementById('loading-overlay');
    window.addEventListener('load', () => {
      setTimeout(() => {
        loadingOverlay.classList.add('hidden');
      }, 400);
    });

    // ---- REAL YOUTUBE SEARCH HOOK (BACKEND NEEDED) ----
    // Example: once you have a backend endpoint /api/youtube-search set up,
    // you could add a toggle and call this function instead of filterVideos().
    async function searchYouTubeBackend(query) {
      // NOTE: This requires a backend route; see Node.js example below.
      const res = await fetch('/api/youtube-search?q=' + encodeURIComponent(query));
      if (!res.ok) return [];
      const data = await res.json();
      // Expecting items with id.videoId and snippet.title/channelTitle
      return (data.items || []).map(item => {
        const vId = item.id.videoId;
        return {
          id: 'yt-' + vId,
          title: item.snippet.title,
          channel: item.snippet.channelTitle,
          url: 'https://www.youtube.com/watch?v=' + vId,
          period: 'Web search',
          years: '',
          why: 'Result from live YouTube search. Double-check that it matches your class and is appropriate.',
          tags: ['web search', 'live']
        };
      });
    }
  </script>
</body>
</html>
